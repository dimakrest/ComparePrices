<ion-modal-view >
    <ion-header-bar class="positive-bg text-center">
        <button class="button button-icon icon ion-ios-close-empty light" ng-click="modal.close()"></button>
        <div class="h1 title light">{{::c.localize.strings['BestShopsHeader']}}</div>

        <!--<button class="button button-icon icon ion-ios-upload-outline light" ng-click="c.ShareCartAndShopDetails()"></button>-->
    </ion-header-bar>

    <ion-content class="content-bg">

        <ion-list>
            <ion-item class="item-stable" style="text-align:right"
                 ng-show="c.missingProducts.length > 0"
                 ng-click="toggleDetails(1000)"
                 ng-class="{active: isDetailsShown(1000)}">
                {{::c.localize.strings['DontHaveAllProducts']}}
                <br>
                {{::c.localize.strings['ShowShopsThatPartiallySuit']}}
                <i class="icon" ng-class="isDetailsShown(1000) ? 'ion-android-arrow-dropup-circle' : 'ion-android-arrow-dropdown-circle'"></i>

            </ion-item>
            <ion-item class="item-accordion" ng-repeat="productCode in c.missingProducts" ng-show="isDetailsShown(1000)">
                <h2 style="text-align:right">{{c.comparedProducts[productCode].Name}}</h2>
            </ion-item>


            <div ng-repeat="shop in c.shopsNearThatHaveNeededProducts track by $index" ng-init="parentIndex = $index">


                <div class="item-stable"
                          ng-click="toggleDetails($index)"
                          ng-class="{active: isDetailsShown($index)}"
                          style="display: flex; flex-wrap: wrap; justify-content: space-between; -webkit-justify-content: space-between;">

                    <div style="width: 50px; align-items: center; -webkit-align-items: center">
                        <h4>{{shop["Distance"]}} {{::c.localize.strings['Kilometer']}}</h4>
                    </div>
                    <div style="flex-wrap: wrap; width: 100px;">
                        <button ng-click="c.OpenWaze(shop['Lat'], shop['Lon']); $event.stopPropagation()" class="waze-button" style="top: 16px;"></button>
                        <button ng-click="c.OpenGoogleMaps(shop['Lat'], shop['Lon']); $event.stopPropagation()" class="maps-button"></button>
                    </div>
                    <div style="text-align:right; align-content: center; -webkit-align-items: center">
                        <h5>{{shop["BrandNameHeb"]}}</h5>
                        <h5 style="color:green">{{shop["PercentsToShowNearPrice"]}}{{::c.localize.strings['CurrencySign']}}{{::c.localize.strings['PriceInStore']}} {{shop["CartPrice"]}}</h5>
                        <h6>{{::c.localize.strings['StoreAddress']}} {{shop["City"]}}, {{shop["Address"]}}</h6>
                    </div>
                    <div style="flex-wrap: wrap; top: 16px; right: 16px; width: 70px;">
                        <img ng-src={{::shop['BrandImage']}} style="top: 16px; right: 16px; width: 40px; height: 40px;">
                        <i class="icon" ng-class="isDetailsShown($index) ? 'ion-android-arrow-dropup-circle' : 'ion-android-arrow-dropdown-circle'"></i>
                    </div>
                    <!--<label class="checkbox">-->
                        <!--<input type="checkbox" ng-checked="shop.IsChecked" ng-model="shop.IsChecked">-->
                    <!--</label>                -->

                </div>

                <ion-item class="item-accordion" ng-repeat="product in shop.Products" ng-show="isDetailsShown(parentIndex)">
                    <h2 style="text-align:right">{{c.comparedProducts[product.ItemCode].Name}}</h2>
                    <h2 style="text-align:left; color:green">{{::c.localize.strings['CurrencySign']}}{{c.comparedProducts[product.ItemCode].Amount * product.ItemPrice  | number : 2}} = {{c.comparedProducts[product.ItemCode].Amount}} * {{::c.localize.strings['CurrencySign']}}{{product.ItemPrice * 1 | number : 2}}</h2>
                </ion-item>
            </div>
        </ion-list>



    </ion-content>
</ion-modal-view>

